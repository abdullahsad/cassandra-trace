'use strict';

var util = require('util');

var generateReplicationText = function generateReplicationText(replicationOptions) {
  if (typeof replicationOptions === 'string') {
    return replicationOptions;
  }

  var properties = [];
  Object.keys(replicationOptions).forEach(function (k) {
    properties.push(util.format("'%s': '%s'", k, replicationOptions[k]));
  });

  return util.format('{%s}', properties.join(','));
};

var generateKeyspaceCreateQuery = function generateKeyspaceCreateQuery(keyspaceName, defaultReplicationStrategy) {
  var replicationText = generateReplicationText(defaultReplicationStrategy);

  var query = util.format('CREATE KEYSPACE IF NOT EXISTS "%s" WITH REPLICATION = %s;', keyspaceName, replicationText);
  return query;
};

exports.generateKeyspaceCreateQuery = generateKeyspaceCreateQuery;

var generateKeyspaceAlterQuery = function generateKeyspaceAlterQuery(keyspaceName, defaultReplicationStrategy) {
  var replicationText = generateReplicationText(defaultReplicationStrategy);

  var query = util.format('ALTER KEYSPACE "%s" WITH REPLICATION = %s;', keyspaceName, replicationText);
  return query;
};

exports.generateKeyspaceAlterQuery = generateKeyspaceAlterQuery;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9nZW5lcmF0b3JzL2tleXNwYWNlLmpzIl0sIm5hbWVzIjpbInV0aWwiLCJyZXF1aXJlIiwiZ2VuZXJhdGVSZXBsaWNhdGlvblRleHQiLCJyZXBsaWNhdGlvbk9wdGlvbnMiLCJwcm9wZXJ0aWVzIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJrIiwicHVzaCIsImZvcm1hdCIsImpvaW4iLCJnZW5lcmF0ZUtleXNwYWNlQ3JlYXRlUXVlcnkiLCJrZXlzcGFjZU5hbWUiLCJkZWZhdWx0UmVwbGljYXRpb25TdHJhdGVneSIsInJlcGxpY2F0aW9uVGV4dCIsInF1ZXJ5IiwiZXhwb3J0cyIsImdlbmVyYXRlS2V5c3BhY2VBbHRlclF1ZXJ5Il0sIm1hcHBpbmdzIjoiOztBQUFBLElBQU1BLE9BQU9DLFFBQVEsTUFBUixDQUFiOztBQUVBLElBQU1DLDBCQUEwQixTQUExQkEsdUJBQTBCLENBQUNDLGtCQUFELEVBQXdCO0FBQ3RELE1BQUksT0FBT0Esa0JBQVAsS0FBOEIsUUFBbEMsRUFBNEM7QUFDMUMsV0FBT0Esa0JBQVA7QUFDRDs7QUFFRCxNQUFNQyxhQUFhLEVBQW5CO0FBQ0FDLFNBQU9DLElBQVAsQ0FBWUgsa0JBQVosRUFBZ0NJLE9BQWhDLENBQXdDLFVBQUNDLENBQUQsRUFBTztBQUM3Q0osZUFBV0ssSUFBWCxDQUFnQlQsS0FBS1UsTUFBTCxDQUFZLFlBQVosRUFBMEJGLENBQTFCLEVBQTZCTCxtQkFBbUJLLENBQW5CLENBQTdCLENBQWhCO0FBQ0QsR0FGRDs7QUFJQSxTQUFPUixLQUFLVSxNQUFMLENBQVksTUFBWixFQUFvQk4sV0FBV08sSUFBWCxDQUFnQixHQUFoQixDQUFwQixDQUFQO0FBQ0QsQ0FYRDs7QUFhQSxJQUFNQyw4QkFBOEIsU0FBOUJBLDJCQUE4QixDQUFDQyxZQUFELEVBQWVDLDBCQUFmLEVBQThDO0FBQ2hGLE1BQU1DLGtCQUFrQmIsd0JBQXdCWSwwQkFBeEIsQ0FBeEI7O0FBRUEsTUFBTUUsUUFBUWhCLEtBQUtVLE1BQUwsQ0FDWiwyREFEWSxFQUVaRyxZQUZZLEVBR1pFLGVBSFksQ0FBZDtBQUtBLFNBQU9DLEtBQVA7QUFDRCxDQVREOztBQVdBQyxRQUFRTCwyQkFBUixHQUFzQ0EsMkJBQXRDOztBQUVBLElBQU1NLDZCQUE2QixTQUE3QkEsMEJBQTZCLENBQUNMLFlBQUQsRUFBZUMsMEJBQWYsRUFBOEM7QUFDL0UsTUFBTUMsa0JBQWtCYix3QkFBd0JZLDBCQUF4QixDQUF4Qjs7QUFFQSxNQUFNRSxRQUFRaEIsS0FBS1UsTUFBTCxDQUNaLDRDQURZLEVBRVpHLFlBRlksRUFHWkUsZUFIWSxDQUFkO0FBS0EsU0FBT0MsS0FBUDtBQUNELENBVEQ7O0FBV0FDLFFBQVFDLDBCQUFSLEdBQXFDQSwwQkFBckMiLCJmaWxlIjoia2V5c3BhY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB1dGlsID0gcmVxdWlyZSgndXRpbCcpO1xuXG5jb25zdCBnZW5lcmF0ZVJlcGxpY2F0aW9uVGV4dCA9IChyZXBsaWNhdGlvbk9wdGlvbnMpID0+IHtcbiAgaWYgKHR5cGVvZiByZXBsaWNhdGlvbk9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHJlcGxpY2F0aW9uT3B0aW9ucztcbiAgfVxuXG4gIGNvbnN0IHByb3BlcnRpZXMgPSBbXTtcbiAgT2JqZWN0LmtleXMocmVwbGljYXRpb25PcHRpb25zKS5mb3JFYWNoKChrKSA9PiB7XG4gICAgcHJvcGVydGllcy5wdXNoKHV0aWwuZm9ybWF0KFwiJyVzJzogJyVzJ1wiLCBrLCByZXBsaWNhdGlvbk9wdGlvbnNba10pKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHV0aWwuZm9ybWF0KCd7JXN9JywgcHJvcGVydGllcy5qb2luKCcsJykpO1xufTtcblxuY29uc3QgZ2VuZXJhdGVLZXlzcGFjZUNyZWF0ZVF1ZXJ5ID0gKGtleXNwYWNlTmFtZSwgZGVmYXVsdFJlcGxpY2F0aW9uU3RyYXRlZ3kpID0+IHtcbiAgY29uc3QgcmVwbGljYXRpb25UZXh0ID0gZ2VuZXJhdGVSZXBsaWNhdGlvblRleHQoZGVmYXVsdFJlcGxpY2F0aW9uU3RyYXRlZ3kpO1xuXG4gIGNvbnN0IHF1ZXJ5ID0gdXRpbC5mb3JtYXQoXG4gICAgJ0NSRUFURSBLRVlTUEFDRSBJRiBOT1QgRVhJU1RTIFwiJXNcIiBXSVRIIFJFUExJQ0FUSU9OID0gJXM7JyxcbiAgICBrZXlzcGFjZU5hbWUsXG4gICAgcmVwbGljYXRpb25UZXh0LFxuICApO1xuICByZXR1cm4gcXVlcnk7XG59O1xuXG5leHBvcnRzLmdlbmVyYXRlS2V5c3BhY2VDcmVhdGVRdWVyeSA9IGdlbmVyYXRlS2V5c3BhY2VDcmVhdGVRdWVyeTtcblxuY29uc3QgZ2VuZXJhdGVLZXlzcGFjZUFsdGVyUXVlcnkgPSAoa2V5c3BhY2VOYW1lLCBkZWZhdWx0UmVwbGljYXRpb25TdHJhdGVneSkgPT4ge1xuICBjb25zdCByZXBsaWNhdGlvblRleHQgPSBnZW5lcmF0ZVJlcGxpY2F0aW9uVGV4dChkZWZhdWx0UmVwbGljYXRpb25TdHJhdGVneSk7XG5cbiAgY29uc3QgcXVlcnkgPSB1dGlsLmZvcm1hdChcbiAgICAnQUxURVIgS0VZU1BBQ0UgXCIlc1wiIFdJVEggUkVQTElDQVRJT04gPSAlczsnLFxuICAgIGtleXNwYWNlTmFtZSxcbiAgICByZXBsaWNhdGlvblRleHQsXG4gICk7XG4gIHJldHVybiBxdWVyeTtcbn07XG5cbmV4cG9ydHMuZ2VuZXJhdGVLZXlzcGFjZUFsdGVyUXVlcnkgPSBnZW5lcmF0ZUtleXNwYWNlQWx0ZXJRdWVyeTtcbiJdfQ==